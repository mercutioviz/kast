# KAST Default Configuration File
# Copy to ~/.config/kast/config.yaml and customize as needed
#
# Configuration priority (highest to lowest):
# 1. CLI overrides (--set plugin.key=value)
# 2. Legacy CLI arguments (deprecated)
# 3. Project-specific config (./kast_config.yaml)
# 4. User config (~/.config/kast/config.yaml)
# 5. System config (/etc/kast/config.yaml)
# 6. Plugin defaults

kast:
  config_version: "1.0"

# Global settings (currently unused, reserved for future features)
global:
  timeout: 300
  retry_count: 2

# Plugin-specific configurations
plugins:
  # Related Sites Discovery Plugin
  # Discovers subdomains and probes for live web services
  related_sites:
    httpx_rate_limit: 10          # Max HTTP requests per second (1-100)
    subfinder_timeout: 300        # Subfinder timeout in seconds (30-3600)
    max_subdomains: null          # Max subdomains to process (null = unlimited)
    httpx_ports: [80, 443, 8080, 8443, 8000, 8888]  # Ports to probe
    httpx_timeout: 10             # Timeout per host in seconds (5-60)
    httpx_threads: 50             # Number of parallel threads (1-200)
  
  # Organization Domain Discovery Plugin
  # Discovers other domains owned by the same organization
  org_discovery:
    crtsh_enabled: true             # Enable Certificate Transparency log search via crt.sh
    dns_analysis_enabled: true      # Enable SPF/DMARC DNS record analysis
    whois_enabled: false            # Enable reverse WHOIS correlation (requires python-whois)
    amass_enabled: false            # Enable OWASP Amass passive enumeration (requires amass binary)
    amass_timeout: 300              # Amass enumeration timeout in seconds (60-900)
    shodan_enabled: false           # Enable Shodan internet-exposed service search (requires API key)
    shodan_api_key: null            # Shodan API key (or set SHODAN_API_KEY env var)
    shodan_max_results: 50          # Max Shodan results to return (1-500)
    crtsh_timeout: 180              # Timeout per crt.sh request in seconds (10-120)
    crtsh_max_retries: 3            # Max retries on crt.sh 503/timeout (0-5)
    crtsh_retry_base_delay: 5.0     # Base delay in seconds for exponential backoff (5s, 10s, 20s)
    crtsh_rate_limit_delay: 3.0     # Delay between crt.sh requests in seconds
    max_domains: 100                # Max discovered domains to report (null = unlimited)
    org_name_override: null         # Override organization name for CT search
    confidence_threshold: 0.3       # Minimum confidence score (0.0-1.0) to include a domain

  # Add configurations for other plugins here as they are updated
  # Example format:
  # plugin_name:
  #   setting1: value1
  #   setting2: value2
