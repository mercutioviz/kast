/* KAST PDF Report Stylesheet - Optimized for WeasyPrint */

/* ===== PAGE SETUP ===== */
@page {
    size: letter;
    margin: 1in 0.75in 1in 0.75in;
    
    @bottom-left {
        content: element(footer-left);
    }
    
    @bottom-center {
        content: element(footer-center);
    }
    
    @bottom-right {
        content: element(footer-right);
    }
}

/* First page (cover) - no footer */
@page:first {
    margin: 0;
}

/* ===== GENERAL STYLES ===== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Helvetica', 'Arial', sans-serif;
    font-size: 10pt;
    line-height: 1.5;
    color: #333;
    background: white;
}

/* ===== COVER PAGE ===== */
.cover-page {
    min-height: 10in; /* Use fixed height instead of 100vh for PDF */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    background: linear-gradient(135deg, #083344 0%, #0a4a63 100%);
    color: white;
    page-break-after: always;
}

.cover-header {
    margin-bottom: 3em;
}

.cover-logo {
    width: 200px;
    height: auto;
    margin-bottom: 2em;
}

.cover-title {
    font-size: 36pt;
    font-weight: 300;
    letter-spacing: 2px;
    margin: 0;
}

.cover-metadata {
    margin: 3em 0;
    font-size: 14pt;
}

.cover-target,
.cover-date {
    margin: 1em 0;
}

.cover-metadata .label {
    font-weight: 300;
    opacity: 0.8;
    margin-right: 0.5em;
}

.cover-metadata .value {
    font-weight: 600;
    font-size: 16pt;
}

.cover-summary {
    margin-top: 4em;
    width: 80%;
}

.cover-summary h2 {
    font-size: 18pt;
    font-weight: 300;
    margin-bottom: 2em;
    opacity: 0.9;
}

.severity-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1.5em;
    margin-bottom: 2em;
}

.severity-card {
    background: rgba(255, 255, 255, 0.15);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    padding: 1.5em;
    text-align: center;
}

.severity-card.high {
    border-color: #ff6b6b;
}

.severity-card.medium {
    border-color: #ffa94d;
}

.severity-card.low {
    border-color: #ffd43b;
}

.severity-card.info {
    border-color: #74c0fc;
}

.severity-count {
    font-size: 32pt;
    font-weight: 700;
    margin-bottom: 0.25em;
}

.severity-label {
    font-size: 11pt;
    opacity: 0.9;
}

.total-summary {
    font-size: 12pt;
    opacity: 0.9;
}

/* ===== PAGE BREAKS ===== */
.page-break {
    page-break-after: always;
}

/* ===== SECTIONS ===== */
.section {
    page-break-inside: avoid;
    margin-bottom: 2em;
}

.section-title {
    font-size: 20pt;
    font-weight: 700;
    color: #083344;
    border-bottom: 3px solid #083344;
    padding-bottom: 0.5em;
    margin-bottom: 1.5em;
    page-break-after: avoid;
}

.subsection-title {
    font-size: 14pt;
    font-weight: 600;
    color: #083344;
    margin-top: 1.5em;
    margin-bottom: 1em;
    page-break-after: avoid;
}

/* ===== EXECUTIVE SUMMARY ===== */
.executive-summary-block {
    margin-bottom: 1.5em;
    page-break-inside: avoid;
}

.plugin-name {
    font-size: 12pt;
    font-weight: 600;
    color: #0a4a63;
    margin-bottom: 0.5em;
}

.executive-summary-content ul,
.executive-summary-block ul {
    margin-left: 1.5em;
    margin-top: 0.5em;
}

.executive-summary-content li,
.executive-summary-block li {
    margin-bottom: 0.5em;
    line-height: 1.6;
}

/* ===== ISSUES ===== */
.no-issues {
    font-size: 11pt;
    font-style: italic;
    color: #666;
    padding: 2em;
    text-align: center;
    background: #f8f9fa;
    border-radius: 4px;
}

.severity-heading {
    font-size: 16pt;
    font-weight: 600;
    margin-top: 2em;
    margin-bottom: 1em;
    padding: 0.5em 0;
    page-break-after: avoid;
}

.high-heading {
    color: #c92a2a;
    border-bottom: 2px solid #c92a2a;
}

.medium-heading {
    color: #e8590c;
    border-bottom: 2px solid #e8590c;
}

.low-heading {
    color: #e67700;
    border-bottom: 2px solid #e67700;
}

.info-heading {
    color: #1971c2;
    border-bottom: 2px solid #1971c2;
}

.issue-card {
    border-left: 4px solid;
    background: #f8f9fa;
    padding: 1em;
    margin-bottom: 1em;
    page-break-inside: avoid;
}

.high-issue {
    border-left-color: #c92a2a;
    background: #fff5f5;
}

.medium-issue {
    border-left-color: #e8590c;
    background: #fff4e6;
}

.low-issue {
    border-left-color: #e67700;
    background: #fff9db;
}

.info-issue {
    border-left-color: #1971c2;
    background: #e7f5ff;
}

.issue-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.75em;
}

.issue-title {
    font-size: 11pt;
    font-weight: 700;
    color: #083344;
}

.issue-category {
    font-size: 9pt;
    color: #666;
    background: white;
    padding: 0.25em 0.75em;
    border-radius: 3px;
}

.issue-meta {
    font-size: 9pt;
    color: #666;
    margin-bottom: 0.75em;
}

.issue-description {
    font-size: 10pt;
    margin-bottom: 0.75em;
    padding: 0.5em;
    background: white;
    border-radius: 3px;
}

.issue-remediation {
    font-size: 10pt;
    margin-top: 0.75em;
    padding: 0.75em;
    background: white;
    border-radius: 3px;
}

/* ===== TOOL RESULTS ===== */
.tool-block {
    margin-bottom: 2em;
    page-break-inside: avoid;
}

.tool-name {
    font-size: 14pt;
    font-weight: 600;
    color: #083344;
    margin-bottom: 1em;
    page-break-after: avoid;
}

.tool-info {
    background: #f1f3f5;
    padding: 1em;
    margin-bottom: 1em;
    border-radius: 4px;
}

.tool-purpose,
.tool-url {
    margin-bottom: 0.5em;
    font-size: 10pt;
}

.tool-url:last-child {
    margin-bottom: 0;
}

.tool-summary {
    margin-bottom: 1em;
    font-size: 10pt;
}

.tool-custom {
    margin-bottom: 1em;
    padding: 1em;
    background: #f8f9fa;
    border-radius: 4px;
}

.tool-details {
    background: #e9ecef;
    padding: 1em;
    margin-bottom: 1em;
    border-radius: 4px;
}

.detail-row {
    margin-bottom: 0.5em;
    font-size: 10pt;
}

.detail-row:last-child {
    margin-bottom: 0;
}

.tool-results {
    margin-bottom: 1em;
}

.tool-report {
    margin-top: 1em;
    font-size: 10pt;
}

.tool-separator {
    border-bottom: 1px solid #dee2e6;
    margin: 2em 0;
}

/* ===== JSON DISPLAY ===== */
.json-display {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    padding: 1em;
    font-family: 'Courier New', monospace;
    font-size: 8pt;
    line-height: 1.4;
    margin-top: 0.5em;
    max-height: 500pt;
    overflow: hidden;
}

.json-object,
.json-array {
    margin-left: 1em;
}

.json-contents {
    margin-left: 1em;
}

.json-item {
    margin: 0.25em 0;
}

.json-key {
    color: #0a4a63;
    font-weight: 600;
}

.json-string {
    color: #087f5b;
}

.json-number {
    color: #d9480f;
}

.json-boolean {
    color: #5f3dc4;
}

.json-null {
    color: #868e96;
    font-style: italic;
}

.json-empty {
    color: #868e96;
}

.json-truncated {
    color: #868e96;
    font-style: italic;
}

/* ===== FOOTER ===== */
.page-footer {
    position: running(footer);
    font-size: 8pt;
    color: #666;
}

.footer-left {
    float: left;
    display: flex;
    align-items: center;
}

.footer-logo {
    height: 16pt;
    width: auto;
    margin-right: 0.5em;
}

.footer-center {
    text-align: center;
}

.footer-right {
    float: right;
}

/* Position footer elements for @page rules */
.page-footer .footer-left {
    position: running(footer-left);
}

.page-footer .footer-center {
    position: running(footer-center);
}

.page-footer .footer-right {
    position: running(footer-right);
}

/* ===== TYPOGRAPHY ===== */
p {
    margin-bottom: 0.75em;
}

strong {
    font-weight: 600;
    color: #212529;
}

ul, ol {
    margin-bottom: 1em;
}

li {
    margin-bottom: 0.25em;
}

a {
    color: #1971c2;
    text-decoration: none;
}

/* ===== UTILITIES ===== */
.report-paragraph {
    margin-bottom: 0.75em;
}

/* Avoid orphans and widows */
p, li {
    orphans: 3;
    widows: 3;
}

/* Keep headings with following content */
h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
    orphans: 3;
    widows: 3;
}
